<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Chọn Địa Chỉ</title>
    <style>
      /* Modal styles */
      #addressModal {
        display: block;
        position: fixed;
        z-index: 1;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.5);
      }

      .modal-content {
        background-color: white;
        margin: 15% auto;
        padding: 20px;
        width: 80%;
        max-width: 500px;
      }

      .modal-content select,
      .modal-content input {
        width: 100%;
        padding: 8px;
        margin-bottom: 10px;
        border: 1px solid white;
        border-radius: 4px;
      }

      .modal-content button {
        padding: 10px 15px;
        background-color: green;
        color: white;
        border: none;
        border-radius: 4px;
        cursor: pointer;
      }

      .modal-content button:hover {
        background-color: lightgreen;
      }

      #openModalBtn {
        padding: 10px 20px;
        background-color: darkcyan;
        color: white;
        border: none;
        border-radius: 4px;
        cursor: pointer;
      }

      #openModalBtn:hover {
        background-color: cyan;
      }

      .alert {
        color: red;
        font-size: 12px;
        margin-top: -5px;
        font-style: italic;
      }
    </style>
  </head>
  <body>
    <!-- Open Modal Button -->
    <button id="openModalBtn">Chọn Địa Chỉ</button>
    <!-- Modal -->
    <div id="addressModal">
      <div class="modal-content">
        <h2>Chọn Địa Chỉ</h2>
        <label for="city">Chọn Thành Phố:</label>
        <select id="city">
          <option value="">Chọn Thành Phố</option>
        </select>
        <div id="city-alert"></div>
        <!-- Cảnh báo dưới thành phố -->

        <label for="district">Chọn Quận / Huyện:</label>
        <select id="district">
          <option value="">Chọn Quận / Huyện</option>
        </select>
        <div id="district-alert"></div>
        <!-- Cảnh báo dưới quận/huyện -->
        <label for="ward">Chọn Phường / Huyện:</label>
        <select id="ward">
          <option value="">Chọn Phường / Huyện</option>
        </select>
        <div id="ward-alert"></div>
        <!-- Cảnh báo dưới phường/huyện -->
        <label for="streetName">Tên Đường:</label>
        <input type="text" id="streetName" placeholder="Nhập tên đường" />
        <div id="streetName-alert"></div>
        <!-- Cảnh báo dưới tên đường -->

        <label for="houseNumber">Số Nhà:</label>
        <input type="text" id="houseNumber" placeholder="Nhập số nhà" />
        <div id="houseNumber-alert"></div>
        <!-- Cảnh báo dưới số nhà -->

        <button id="submitAddressBtn">Lưu Địa Chỉ</button>
        <button id="closeModalBtn" style="background-color: red">Đóng</button>
      </div>
    </div>
  </body>
  <script>
    // Dữ liệu về thành phố và quận/huyện
    const locations = [
      {
        city: "Hà Nội",
        districts: [
          {
            district: "Quận Ba Đình",
            wards: [
              "Cống Vị",
              "Điện Biên",
              "Đội Cấn",
              "Giảng Võ",
              "Kim Mã",
              "Liễu Giai",
              "Ngọc Hà",
              "Ngọc Khánh",
              "Nguyễn Trung Trực",
              "Phúc Xá",
              "Quán Thánh",
              "Thành Công",
              "Trúc Bạch",
              "Vĩnh Phúc",
            ],
          },
          {
            district: "Quận Hoàn Kiếm",
            wards: [
              "Chương Dương Độ",
              "Cửa Đông",
              "Cửa Nam",
              "Đồng Xuân",
              "Hàng Bạc",
              "Hàng Bài",
              "Hàng Bồ",
              "Hàng Bông",
              "Hàng Buồm",
              "Hàng Đào",
              "Hàng Gai",
              "Hàng Mã",
              "Hàng Trống",
              "Lý Thái Tổ",
              "Phan Chu Trinh",
              "Phúc Tân",
              "Tràng Tiền",
              "Trần Hưng Đạo",
            ],
          },
          {
            district: "Quận Đống Đa",
            wards: [
              "Cát Linh",
              "Giảng Võ",
              "Hàng Bột",
              "Khâm Thiên",
              "Khương Thượng",
              "Kim Liên",
              "Láng Hạ",
              "Láng Thượng",
              "Nam Đồng",
              "Ngã Tư Sở",
              "Ô Chợ Dừa",
              "Phương Liên",
              "Phương Mai",
              "Quang Trung",
              "Quốc Tử Giám",
              "Thịnh Quang",
              "Thổ Quan",
              "Trung Liệt",
              "Trung Phụng",
              "Trung Tự",
              "Văn Chương",
              "Văn Miếu",
            ],
          },
          {
            district: "Quận Hai Bà Trưng",
            wards: [
              "Bạch Đằng",
              "Bách Khoa",
              "Bạch Mai",
              "Cầu Dền",
              "Đống Mác",
              "Đồng Nhân",
              "Đồng Tâm",
              "Đồng Xuân",
              "Lê Đại Hành",
              "Minh Khai",
              "Nguyễn Du",
              "Phạm Đình Hổ",
              "Phố Huế",
              "Quỳnh Lôi",
              "Quỳnh Mai",
              "Thanh Lương",
              "Thanh Nhàn",
              "Trương Định",
              "Vĩnh Tuy",
            ],
          },
          {
            district: "Quận Thanh Xuân",
            wards: [
              "Hạ Đình",
              "Khương Đình",
              "Khương Mai",
              "Khương Trung",
              "Nhân Chính",
              "Phương Liệt",
              "Thanh Xuân Bắc",
              "Thanh Xuân Nam",
              "Thanh Xuân Trung",
              "Thượng Đình",
            ],
          },
          {
            district: "Quận Tây Hồ",
            wards: [
              "Bưởi",
              "Nhật Tân",
              "Phú Thượng",
              "Quảng An",
              "Thụy Khuê",
              "Tứ Liên",
              "Xuân La",
              "Yên Phụ",
            ],
          },
          {
            district: "Quận Cầu Giấy",
            wards: [
              "Dịch Vọng",
              "Dịch Vọng Hậu",
              "Mai Dịch",
              "Nghĩa Đô",
              "Nghĩa Tân",
              "Quan Hoa",
              "Trung Hòa",
              "Yên Hòa",
            ],
          },
          {
            district: "Quận Hoàng Mai",
            wards: [
              "Đại Kim",
              "Định Công",
              "Giáp Bát",
              "Hoàng Liệt",
              "Hoàng Văn Thụ",
              "Lĩnh Nam",
              "Mai Động",
              "Tân Mai",
              "Thanh Trì",
              "Thịnh Liệt",
              "Trần Phú",
              "Tương Mai",
              "Vĩnh Hưng",
              "Yên Sở",
            ],
          },
          {
            district: "Quận Long Biên",
            wards: [
              "Bồ Đề",
              "Cự Khối",
              "Đức Giang",
              "Gia Thụy",
              "Giang Biên",
              "Long Biên",
              "Ngọc Lâm",
              "Ngọc Thụy",
              "Phúc Đồng",
              "Phúc Lợi",
              "Sài Đồng",
              "Thạch Bàn",
              "Thượng Thanh",
              "Việt Hưng",
            ],
          },
          {
            district: "Quận Nam Từ Liêm",
            wards: [
              "Cầu Diễn",
              "Đại Mỗ",
              "Mễ Trì",
              "Mỹ Đình 1",
              "Mỹ Đình 2",
              "Phú Đô",
              "Phương Canh",
              "Tây Mỗ",
              "Trung Văn",
              "Xuân Phương",
            ],
          },
          {
            district: "Quận Bắc Từ Liêm",
            wards: [
              "Cổ Nhuế 1",
              "Cổ Nhuế 2",
              "Đông Ngạc",
              "Đức Thắng",
              "Liên Mạc",
              "Minh Khai",
              "Phú Diễn",
              "Phúc Diễn",
              "Tây Tựu",
              "Thượng Cát",
              "Thụy Phương",
              "Xuân Đỉnh",
              "Xuân Tảo",
            ],
          },
          {
            district: "Huyện Gia Lâm",
            wards: [
              "Cát Quế",
              "Đặng Xá",
              "Đa Tốn",
              "Đình Xuyên",
              "Dương Hà",
              "Dương Quang",
              "Dương Xá",
              "Kim Lan",
              "Kim Sơn",
              "Lệ Chi",
              "Ninh Hiệp",
              "Phù Đổng",
              "Phú Thị",
              "Trâu Quỳ",
              "Yên Thường",
              "Yên Viên",
            ],
          },
          {
            district: "Huyện Đông Anh",
            wards: [
              "Bắc Hồng",
              "Cổ Loa",
              "Dục Tú",
              "Đại Mạch",
              "Đông Hội",
              "Hải Bối",
              "Kim Chung",
              "Kim Nỗ",
              "Liên Hà",
              "Mai Lâm",
              "Nguyên Khê",
              "Tàm Xá",
              "Thụy Lâm",
              "Tiên Dương",
              "Uy Nỗ",
              "Vân Hà",
              "Vân Nội",
              "Việt Hùng",
              "Vĩnh Ngọc",
              "Võng La",
              "Xuân Canh",
              "Xuân Nộn",
            ],
          },
          {
            district: "Huyện Sóc Sơn",
            wards: [
              "Bắc Sơn",
              "Đông Xuân",
              "Hiền Ninh",
              "Hồng Kỳ",
              "Kim Lũ",
              "Mai Đình",
              "Minh Phú",
              "Minh Trí",
              "Nam Sơn",
              "Phù Linh",
              "Phú Cường",
              "Phú Minh",
              "Phủ Lỗ",
              "Quang Tiến",
              "Tân Dân",
              "Tân Hưng",
              "Thụy Hương",
              "Tiên Dược",
              "Trung Giã",
              "Việt Long",
              "Xuân Giang",
              "Xuân Thu",
            ],
          },
          {
            district: "Huyện Thanh Trì",
            wards: [
              "Đại Áng",
              "Đông Mỹ",
              "Duyên Hà",
              "Hữu Hòa",
              "Liên Ninh",
              "Ngọc Hồi",
              "Tả Thanh Oai",
              "Tam Hiệp",
              "Tân Triều",
              "Thanh Liệt",
              "Tứ Hiệp",
              "Vạn Phúc",
              "Vĩnh Quỳnh",
              "Yên Mỹ",
            ],
          },
          {
            district: "Huyện Thường Tín",
            wards: [
              "Dũng Tiến",
              "Hà Hồi",
              "Hiền Giang",
              "Hòa Bình",
              "Hồng Vân",
              "Khánh Hà",
              "Liên Phương",
              "Minh Cường",
              "Nghiêm Xuyên",
              "Nguyễn Trãi",
              "Nhị Khê",
              "Ninh Sở",
              "Quất Động",
              "Thắng Lợi",
              "Thống Nhất",
              "Thư Phú",
              "Tô Hiệu",
              "Tự Nhiên",
              "Vạn Điểm",
              "Vân Tảo",
              "Văn Bình",
              "Văn Phú",
              "Văn Tự",
              "Vân Tử",
              "Vũ Lăng",
              "Xà Cầu",
              "Duyên Thái",
            ],
          },
        ],
      },
      {
        city: "Hồ Chí Minh",
        districts: [
          {
            district: "Quận 1",
            wards: [
              "Bến Nghé",
              "Bến Thành",
              "Cầu Kho",
              "Cầu Ông Lãnh",
              "Cô Giang",
              "Nguyễn Thái Bình",
              "Phạm Ngũ Lão",
            ],
          },
          {
            district: "Quận 2",
            wards: [
              "Thảo Điền",
              "An Phú",
              "An Khánh",
              "Bình An",
              "Bình Trưng Đông",
              "Bình Trưng Tây",
              "Cát Lái",
              "Thạnh Mỹ Lợi",
            ],
          },
          {
            district: "Quận 3",
            wards: [
              "Phường 1",
              "Phường 2",
              "Phường 3",
              "Phường 4",
              "Phường 5",
              "Phường 6",
              "Phường 7",
              "Phường 8",
              "Phường 9",
              "Phường 10",
            ],
          },
          {
            district: "Quận 4",
            wards: [
              "Phường 1",
              "Phường 2",
              "Phường 3",
              "Phường 4",
              "Phường 5",
              "Phường 6",
              "Phường 8",
              "Phường 9",
            ],
          },
          {
            district: "Quận 5",
            wards: [
              "Phường 1",
              "Phường 2",
              "Phường 3",
              "Phường 4",
              "Phường 5",
              "Phường 6",
              "Phường 7",
              "Phường 8",
            ],
          },
          {
            district: "Quận 6",
            wards: [
              "Phường 1",
              "Phường 2",
              "Phường 3",
              "Phường 4",
              "Phường 5",
              "Phường 6",
              "Phường 7",
              "Phường 8",
            ],
          },
          {
            district: "Quận 7",
            wards: [
              "Tân Thuận Đông",
              "Tân Thuận Tây",
              "Tân Kiểng",
              "Tân Hưng",
              "Bình Thuận",
              "Phú Mỹ",
              "Tân Phong",
              "Tân Quy",
            ],
          },
          {
            district: "Quận 8",
            wards: [
              "Phường 1",
              "Phường 2",
              "Phường 3",
              "Phường 4",
              "Phường 5",
              "Phường 6",
              "Phường 7",
              "Phường 8",
            ],
          },
          {
            district: "Quận 9",
            wards: [
              "Long Bình",
              "Long Phước",
              "Long Thạnh Mỹ",
              "Long Trường",
              "Phước Bình",
              "Phước Long A",
              "Phước Long B",
            ],
          },
          {
            district: "Quận 10",
            wards: [
              "Phường 1",
              "Phường 2",
              "Phường 3",
              "Phường 4",
              "Phường 5",
              "Phường 6",
              "Phường 7",
              "Phường 8",
            ],
          },
          {
            district: "Quận 11",
            wards: [
              "Phường 1",
              "Phường 2",
              "Phường 3",
              "Phường 4",
              "Phường 5",
              "Phường 6",
              "Phường 7",
              "Phường 8",
            ],
          },
          {
            district: "Quận 12",
            wards: [
              "Thạnh Xuân",
              "Thạnh Lộc",
              "Thới An",
              "Tân Chánh Hiệp",
              "An Phú Đông",
              "Tân Thới Hiệp",
              "Tân Hưng Thuận",
            ],
          },
          {
            district: "Tân Bình",
            wards: [
              "Phường 1",
              "Phường 2",
              "Phường 3",
              "Phường 4",
              "Phường 5",
              "Phường 6",
              "Phường 7",
              "Phường 8",
            ],
          },
          {
            district: "Tân Phú",
            wards: [
              "Hiệp Tân",
              "Hòa Thạnh",
              "Phú Thọ Hòa",
              "Phú Thạnh",
              "Phú Trung",
              "Sơn Kỳ",
              "Tân Qúy",
              "Tân Sơn Nhì",
            ],
          },
          {
            district: "Bình Thạnh",
            wards: [
              "Phường 1",
              "Phường 2",
              "Phường 3",
              "Phường 4",
              "Phường 5",
              "Phường 6",
              "Phường 7",
              "Phường 8",
            ],
          },
          {
            district: "Gò Vấp",
            wards: [
              "Phường 1",
              "Phường 2",
              "Phường 3",
              "Phường 4",
              "Phường 5",
              "Phường 6",
              "Phường 7",
              "Phường 8",
            ],
          },
          {
            district: "Phú Nhuận",
            wards: [
              "Phường 1",
              "Phường 2",
              "Phường 3",
              "Phường 4",
              "Phường 5",
              "Phường 6",
              "Phường 7",
              "Phường 8",
            ],
          },
          {
            district: "Thủ Đức",
            wards: [
              "Bình Chiểu",
              "Bình Thọ",
              "Hiệp Bình Chánh",
              "Hiệp Bình Phước",
              "Linh Chiểu",
              "Linh Đông",
              "Linh Tây",
              "Linh Trung",
            ],
          },
        ],
      },
    ];

    const citySelector = document.getElementById("city");
    const districtSelector = document.getElementById("district");
    const wardSelector = document.getElementById("ward");
    const modal = document.getElementById("addressModal");
    const openModalBtn = document.getElementById("openModalBtn");
    const closeModalBtn = document.getElementById("closeModalBtn");

    // Mở Modal
    openModalBtn.addEventListener("click", () => {
      modal.style.display = "block";
    });

    // Đóng Modal
    closeModalBtn.addEventListener("click", () => {
      modal.style.display = "none";
    });

    citySelector.addEventListener("change", () => {
      districtSelector.innerHTML = '<option value="">Chọn Quận</option>'; // Xóa quận cũ
      wardSelector.innerHTML = '<option value="">Chọn Phường / Huyện</option>'; // Xóa phường cũ

      const selectedCity = locations.find(
        (location) => location.city === citySelector.value
      );

      if (selectedCity && selectedCity.districts) {
        selectedCity.districts.forEach((district) => {
          const option = document.createElement("option");
          option.value = district.district;
          option.textContent = district.district;
          districtSelector.appendChild(option);
        });
      }
    });

    // Cập nhật Phường khi chọn Quận
    districtSelector.addEventListener("change", () => {
      wardSelector.innerHTML = '<option value="">Chọn Phường / Huyện</option>'; // Xóa phường cũ

      const selectedCity = locations.find(
        (location) => location.city === citySelector.value
      );
      const selectedDistrict = selectedCity
        ? selectedCity.districts.find(
            (district) => district.district === districtSelector.value
          )
        : null;

      if (selectedDistrict && selectedDistrict.wards) {
        selectedDistrict.wards.forEach((ward) => {
          const option = document.createElement("option");
          option.value = ward;
          option.textContent = ward;
          wardSelector.appendChild(option);
        });
      }
    });
    // Đóng Modal khi nhấn ngoài vùng modal
    window.onclick = function (event) {
      if (event.target == modal) {
        modal.style.display = "none";
      }
    };

    // Hàm kiểm tra và hiển thị cảnh báo
    function validateField(field, fieldName, alertElement) {
      if (!field.value || field.value.trim() === "") {
        alertElement.textContent = `${fieldName} không được để trống!`;
        alertElement.classList.add("alert");
      } else {
        alertElement.textContent = "";
        alertElement.classList.remove("alert");
      }
    }

    // Thêm sự kiện "blur" cho các trường input và select
    citySelector.addEventListener("blur", function () {
      validateField(this, "Thành Phố", document.getElementById("city-alert"));
    });

    districtSelector.addEventListener("blur", function () {
      validateField(this, "Quận", document.getElementById("district-alert"));
    });

    wardSelector.addEventListener("blur", function () {
      validateField(
        this,
        "Phường / Huyện",
        document.getElementById("ward-alert")
      );
    });
    document.getElementById("streetName").addEventListener("blur", function () {
      validateField(
        this,
        "Tên Đường",
        document.getElementById("streetName-alert")
      );
    });

    document
      .getElementById("houseNumber")
      .addEventListener("blur", function () {
        validateField(
          this,
          "Số Nhà",
          document.getElementById("houseNumber-alert")
        );
      });

    // Lưu địa chỉ khi nhấn nút
    document.getElementById("save-Address").addEventListener("click", () => {
      let selectedCity = citySelector.value;
      let selectedDistrict = districtSelector.value;
      let houseNumber = document.getElementById("houseNumber").value;
      let wardName = document.getElementById("ward").value;

      // Kiểm tra nếu tất cả các trường đều có giá trị
      if (selectedCity && selectedDistrict && houseNumber && wardName) {
        // Cấu trúc lại địa chỉ theo cú pháp "số nhà, tên đường, quận/huyện, thành phố"
        const fullAddress = `${houseNumber}, ${wardName}, ${selectedDistrict}, ${selectedCity}`;

        // Hiển thị hoặc lưu địa chỉ
        alert(`Địa chỉ đã lưu: ${fullAddress}`);
        console.log(fullAddress); // Bạn có thể thay đổi nơi này để lưu vào một biến hoặc cơ sở dữ liệu

        // Lưu vào localStorage (giả sử có ID người dùng)

        let users = JSON.parse(localStorage.getItem("list-users"));
        let user = users.find((u) => u.id === userID);
        if (user) {
          user.address = fullAddress;
          localStorage.setItem("list-users", JSON.stringify(users));
          console.log("Đã thêm địa chỉ giao hàng");
        } else {
          console.log("Không tìm thấy người dùng");
        }

        // Đóng modal sau khi lưu
        modal.style.display = "none";
      } else {
        alert("Vui lòng điền đầy đủ thông tin.");
      }
    });

    // Tự động điền các thành phố vào dropdown khi load trang
    locations.forEach((location) => {
      const option = document.createElement("option");
      option.value = location.city;
      option.textContent = location.city;
      citySelector.appendChild(option);
    });
  </script>
</html>
